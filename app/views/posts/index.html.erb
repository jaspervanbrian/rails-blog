<% @title = "All Posts" %>

<div class="container">
	<div class="row">
		<div class="col-4">
			<%= form_with scope: :post, model: @post, class: 'form-horizontal needs-validation', html: {novalidate: true}, local: true do |form| %>
				<div class="form-group">
					<%= form.text_field :title, :class => "form-control #{ @post.errors.include?(:title) ? 'is-invalid' : ''}", :placeholder => 'Title of your post', maxlength: 50 %>
					<% if @post.errors.include?(:title) %>
						<div class="invalid-feedback">
							<%= @post.errors[:title].join(", ") %>
						</div>
					<% end %>
				</div>
				<div class="form-group">
					<%= form.text_area :body, :class => "form-control #{ @post.errors.include?(:body) ? 'is-invalid' : ''}", :placeholder => 'Say something here!', :rows => 5 %>
					<% if @post.errors.include?(:body) %>
						<div class="invalid-feedback">
							<%= @post.errors[:body].join(", ") %>
						</div>
					<% end %>
				</div>
				<div class="form-group">
					<%= form.submit "Post", :class => 'btn btn-danger' %>
				</div>
			<% end %>
		</div>
		<div class="col-8">
			<% if @posts.length > 0 %>
				<div class="list-group">
					<div style="height: 75vh !important; overflow-y: scroll;">
						<%
							@posts.each do |post|
						%>
							<div class="card mb-4">
								<div class="card-body">
									<h4 class="card-title mb-1"><%= post.title %></h4>
									<h6 class="card-subtitle mb-2 text-muted"><%= post.user.name %></h6>
									<p class="card-text mb-1">
										<%= simple_format(truncate(post.body, length: 100)) %>
									</p>
									<%= link_to("Read more...", post_path(post) , class: "btn btn-outline-dark") %>
								</div>
								<div class="card-footer">
									<small class="text-muted"><%= post.created_at.strftime("%B %d, %Y | %A, %l:%M %p") %></small>
								</div>
							</div>
						<%
							end
						%></div>
				</div>
				<%= paginate @posts, window: 3 %>
			<% else %>
				<div class="alert alert-info">
					No posts yet.
				</div>
			<% end %>
		</div>
	</div>
</div>